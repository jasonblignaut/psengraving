<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pretty Stitched Engraving - Custom laser cutting and engraving services in South Africa. Personalized gifts, tumblers, and more—crafted with precision and artistry.">
    <meta name="keywords" content="Laser Engraving, Custom Engraving, Laser Cutting, Personalized Gifts, Custom Tumblers, Pretty Stitched Engraving, Centurion, South Africa, laser art">
    <meta name="author" content="Pretty Stitched Engraving">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Pretty Stitched Engraving - Custom Laser Engraving & Cutting">
    <meta property="og:description" content="Custom laser cutting and engraving services in Centurion, South Africa. Personalized designs for gifts and more.">
    <meta property="og:image" content="https://engravinglaser.co.za/PSE/pseLogoO.jpg">
    <meta property="og:url" content="https://engravinglaser.co.za">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Pretty Stitched Engraving - Custom Laser Engraving & Cutting">
    <meta name="twitter:description" content="Custom laser cutting and engraving services in Centurion, South Africa. Personalized designs for gifts and more.">
    <meta name="twitter:image" content="https://engravinglaser.co.za/PSE/pseLogoO.jpg">
    <link rel="icon" type="image/x-icon" href="/PSE/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/PSE/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/PSE/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/PSE/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/PSE/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/PSE/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/PSE/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/PSE/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/PSE/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/PSE/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/PSE/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/PSE/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/PSE/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/PSE/favicon-16x16.png">
    <link rel="manifest" href="/PSE/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/PSE/ms-icon-144x144.png">
    <meta name="theme-color" content="#0d0d1b">
    <title>Pretty Stitched Engraving - Custom Laser Engraving & Cutting</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XWZS8F10JE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XWZS8F10JE');
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "Pretty Stitched Engraving",
      "description": "Custom laser cutting and engraving services in South Africa. Personalised Designs - You Say & We Do.",
      "url": "https://engravinglaser.co.za",
      "telephone": "+27832227144",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "5 Hilton Street",
        "addressLocality": "Centurion",
        "addressRegion": "Gauteng",
        "postalCode": "0157",
        "addressCountry": "ZA"
      },
      "openingHours": "Mo-Fr 09:00-17:00",
      "sameAs": [
        "https://www.tiktok.com/@diedrake",
        "https://www.facebook.com/share/1AGJEC1RfQ/?mibextid=wwXIfr"
      ],
      "image": "https://engravinglaser.co.za/PSE/pseLogoO.jpg",
      "keywords": "laser engraving, custom engraving, laser cutting, personalised gifts, South Africa",
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": "-25.8603",
        "longitude": "28.1894"
      }
    }
    </script>
    <style>
        :root {
            --primary-color: #00aaff;
            --secondary-color: #ff00ff;
            --bg-dark: #0d0d1b;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-light: #ffffff;
            --text-muted: #e0e0e0;
            --glow-intensity: 20px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            font-size: 16px;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: transparent;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary-color);
            color: white;
            padding: 8px;
            z-index: 10000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        .engraving-spark {
            position: fixed;
            width: 5px;
            height: 5px;
            background: linear-gradient(45deg, var(--primary-color), #ffffff, var(--secondary-color));
            pointer-events: none;
            z-index: 10001;
            opacity: 0.8;
            box-shadow: 0 0 10px var(--primary-color), 0 0 15px var(--secondary-color);
            animation: engravingFlicker 0.4s ease-out forwards;
        }

        .engraving-flare {
            position: fixed;
            width: 3px;
            height: 8px;
            background: linear-gradient(var(--primary-color), transparent);
            pointer-events: none;
            z-index: 10001;
            opacity: 0.6;
            box-shadow: 0 0 5px var(--primary-color);
            animation: flareBurst 0.5s ease-out forwards;
        }

        @keyframes engravingFlicker {
            0% { transform: scale(1) rotate(0deg); opacity: 0.8; }
            50% { transform: scale(1.3) rotate(45deg); opacity: 0.5; }
            100% { transform: scale(0) rotate(90deg); opacity: 0; }
        }

        @keyframes flareBurst {
            0% { transform: translateY(0) rotate(30deg); opacity: 0.6; }
            100% { transform: translateY(10px) rotate(30deg); opacity: 0; }
        }

        .laser-beam {
            position: fixed;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            box-shadow: 0 0 10px var(--primary-color);
            animation: laserBeamFade 3s ease-in-out forwards;
        }

        .laser-beam.vertical {
            width: 2px;
            height: 100vh;
            animation: laserBeamFadeVertical 3s ease-in-out forwards;
        }

        .laser-beam.horizontal {
            width: 100vw;
            height: 2px;
            animation: laserBeamFadeHorizontal 3s ease-in-out forwards;
        }

        @keyframes laserBeamFade {
            0% { opacity: 0; }
            20% { opacity: 0.6; }
            80% { opacity: 0.6; }
            100% { opacity: 0; }
        }

        @keyframes laserBeamFadeHorizontal {
            0% { opacity: 0; transform: translateX(-100%); }
            20% { opacity: 0.6; transform: translateX(-50%); }
            80% { opacity: 0.6; transform: translateX(50%); }
            100% { opacity: 0; transform: translateX(100%); }
        }

        @keyframes laserBeamFadeVertical {
            0% { opacity: 0; transform: translateY(-100%); }
            20% { opacity: 0.6; transform: translateY(-50%); }
            80% { opacity: 0.6; transform: translateY(50%); }
            100% { opacity: 0; transform: translateY(100%); }
        }

        .background {
            position: fixed;
            inset: 0;
            z-index: -2;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease;
        }

        .background-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8) contrast(1.3);
        }

        .background-cube {
            position: absolute;
            width: 100px;
            height: 100px;
            transform-style: preserve-3d;
            animation: rotateCube 10s infinite linear;
        }

        .background-cube div {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 170, 255, 0.3) url('/PSE/pseLogoO.jpg') center/cover no-repeat;
            border: 1px solid var(--primary-color);
            box-shadow: 0 0 10px var(--primary-color);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .background-cube.show-logos div {
            opacity: 0.8;
        }

        .background-cube .front { transform: translateZ(50px); }
        .background-cube .back { transform: translateZ(-50px) rotateY(180deg); }
        .background-cube .left { transform: rotateY(-90deg) translateZ(50px); }
        .background-cube .right { transform: rotateY(90deg) translateZ(50px); }
        .background-cube .top { transform: rotateX(90deg) translateZ(50px); }
        .background-cube .bottom { transform: rotateX(-90deg) translateZ(50px); }

        @keyframes rotateCube {
            0% { transform: rotateX(0deg) rotateY(0deg); }
            100% { transform: rotateX(360deg) rotateY(360deg); }
        }

        .background-fallback {
            width: 100%;
            height: 100%;
            background: url('/PSE/background.jpg') no-repeat center/cover;
            display: none;
        }

        .background::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7));
            z-index: -1;
        }

        .audio-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 13, 27, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.8s ease;
        }

        .audio-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .audio-overlay button {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1rem, 3vw, 1.8rem);
            text-transform: uppercase;
            cursor: pointer;
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            white-space: nowrap;
        }

        .audio-overlay button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: hologramSwipe 2.5s infinite;
        }

        @keyframes hologramSwipe {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .audio-overlay button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 calc(var(--glow-intensity) * 1.5) var(--primary-color);
        }

        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .preloader::before {
            content: '';
            width: 50px;
            height: 50px;
            border: 5px solid var(--primary-color);
            border-top: 5px solid var(--secondary-color);
            border-radius: 50%;
            animation: cyberSpin 1.2s linear infinite;
            box-shadow: 0 0 15px var(--primary-color);
        }

        @keyframes cyberSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .preloader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(26, 26, 46, 0.3);
            backdrop-filter: blur(15px);
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            border-bottom: 1     border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: opacity 0.3s ease, transform 0.3s;
        }

        header.hidden {
            opacity: 0;
            transform: translateY(-100%);
        }

        nav {
            display: none;
            flex-direction: column;
            align-items: center;
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            background: rgba(26, 26, 46, 0.9);
            padding: 1rem;
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            z-index: 999;
        }

        nav.active {
            display: flex;
        }

        nav a {
            color: var(--text-light);
            text-decoration: none;
            margin: 0.8rem 0;
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1rem, 3vw, 1.2rem);
            text-transform: uppercase;
            position: relative;
            transition: all 0.3s;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width 0.3s;
        }

        nav a:hover::after, nav a:focus::after {
            width: 100%;
        }

        nav a:hover, nav a:focus {
            color: var(--primary-color);
            text-shadow: 0 0 10px var(--primary-color);
        }

        .hamburger {
            display: block;
            cursor: pointer;
            font-size: clamp(1.5rem, 4vw, 2rem);
            color: var(--text-light);
            transition: transform 0.3s;
            padding: 0.5rem;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        .hamburger:hover, .hamburger:focus {
            transform: scale(1.2);
        }

        .whatsapp-button, .audio-toggle, .back-to-top {
            position: fixed;
            z-index: 1000;
            transition: transform 0.3s;
        }

        .whatsapp-button {
            bottom: 5rem;
            left: 1rem;
        }

        .whatsapp-button img {
            width: clamp(50px, 10vw, 70px);
            height: clamp(50px, 10vw, 70px);
            transition: transform 0.3s;
        }

        .whatsapp-button:hover img, .whatsapp-button:focus img {
            transform: scale(1.15);
        }

        .audio-toggle {
            bottom: 1rem;
            left: 1rem;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: clamp(50px, 8vw, 60px);
            height: clamp(50px, 8vw, 60px);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            cursor: pointer;
        }

        .audio-toggle:hover, .audio-toggle:focus {
            transform: scale(1.15);
            box-shadow: 0 0 calc(var(--glow-intensity) * 1.5) var(--primary-color);
        }

        .back-to-top {
            bottom: 1rem;
            right: 1rem;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: clamp(50px, 8vw, 60px);
            height: clamp(50px, 8vw, 60px);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            text-decoration: none;
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            transition: transform 0.3s, box-shadow 0.3s, opacity 0.3s;
            opacity: 0;
        }

        .back-to-top.visible {
            opacity: 1;
        }

        .back-to-top:hover, .back-to-top:focus {
            transform: scale(1.15);
            box-shadow: 0 0 calc(var(--glow-intensity) * 1.5) var(--primary-color);
        }

        .fullscreen-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10002;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .fullscreen-viewer.active {
            opacity: 1;
            pointer-events: auto;
        }

        .fullscreen-viewer img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border: 2px solid var(--primary-color);
            box-shadow: 0 0 20px var(--primary-color);
            border-radius: 10px;
        }

        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            text-align: center;
            padding: 4rem 1rem 2rem;
            position: relative;
            overflow: hidden;
            opacity: 0;
            animation: fadeIn 2s forwards 1s;
            z-index: 1;
        }

        .hero::before {
            content: '';
            position: absolute;
            width: 300%;
            height: 300%;
            background: radial-gradient(circle, rgba(0, 170, 255, 0.3), transparent 70%);
            animation: heroPulse 8s infinite;
            z-index: -1;
        }

        @keyframes heroPulse {
            0% { transform: scale(1) translateX(-50%) translateY(-50%); opacity: 0.3; }
            50% { transform: scale(1.1) translateX(-50%) translateY(-50%); opacity: 0.5; }
            100% { transform: scale(1) translateX(-50%) translateY(-50%); opacity: 0.3; }
        }

        .hero .title-container {
            display: flex;
            flex-direction: row;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            order: 1;
            margin-top: 4rem;
        }

        .hero .title-container span {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.8rem, 6vw, 3.5rem);
            background: linear-gradient(90deg, #00aaff, #ff00ff, #ffaa00, #00aaff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 5px #ffffff, 0 0 10px #ffffff, 0 0 15px rgba(255, 255, 255, 0.8);
            background: rgba(0, 0, 0, 0.5);
            padding: 0.3rem 0.5rem;
            border-radius: 8px;
            z-index: 2;
            letter-spacing: 1px;
            font-weight: 900;
            box-shadow: 0 0 2px var(--primary-color);
        }

        .hero img {
            width: clamp(200px, 30vw, 250px);
            height: clamp(200px, 30vw, 250px);
            border: 4px solid var(--primary-color);
            box-shadow: 0 0 25px rgba(0, 170, 255, 0.7), 0 0 40px rgba(0, 170, 255, 0.9);
            animation: glow 2s infinite alternate;
            z-index: 2;
            order: 2;
            position: relative;
        }

        .hero img.explode {
            animation: glow 2s infinite alternate, explodeFade 5s forwards;
        }

        .hero img.explode::before,
        .hero img.explode::after {
            content: '';
            position: absolute;
            width: 50px;
            height: 50px;
            background: url('/PSE/pseLogoO.jpg') center/cover no-repeat;
            z-index: 3;
        }

        .hero img.explode::before {
            top: -20px;
            left: -20px;
            animation: pieceToCube1 2s ease-in forwards 3s;
        }

        .hero img.explode::after {
            bottom: -20px;
            right: -20px;
            animation: pieceToCube2 2s ease-in forwards 3s;
        }

        @keyframes pieceToCube1 {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(-150px, -150px) scale(0.5); opacity: 0; }
        }

        @keyframes pieceToCube2 {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(150px, 150px) scale(0.5); opacity: 0; }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 25px rgba(0, 170, 255, 0.7); }
            100% { box-shadow: 0 0 40px rgba(0, 170, 255, 0.9); }
        }

        @keyframes explodeFade {
            0% { transform: scale(1); opacity: 1; }
            80% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .hero p {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.4rem, 4vw, 2.5rem);
            color: #ffffff;
            background: rgba(0, 0, 0, 0.5);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            max-width: 90%;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
            z-index: 2;
            order: 3;
            letter-spacing: 1px;
            font-weight: 700;
            box-shadow: 0 0 2px var(--primary-color);
        }

        .hero .cta-button {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 2.5rem;
            text-decoration: none;
            border-radius: 30px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            z-index: 2;
            font-size: clamp(1rem, 3vw, 1.5rem);
            order: 4;
        }

        .hero .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.3s;
        }

        .hero .cta-button:hover::before, .hero .cta-button:focus::before {
            left: 100%;
        }

        .hero .cta-button:hover, .hero .cta-button:focus {
            box-shadow: 0 0 calc(var(--glow-intensity) * 2) var(--primary-color);
            transform: scale(1.1);
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        section {
            padding: 3rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
            scroll-margin-top: 80px;
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            animation: sectionFadeIn 0.8s ease forwards;
        }

        @keyframes sectionFadeIn {
            0% { opacity: 0; transform: translateY(50px) scale(0.95); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        section.visible {
            animation: sectionFadeIn 0.8s ease forwards;
        }

        #about {
            min-height: auto;
        }

        #products, #gallery, #contact {
            min-height: 100vh;
        }

        section h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.5rem, 6vw, 3rem);
            text-align: center;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2rem;
            text-transform: uppercase;
            text-shadow: 0 0 2px var(--primary-color), 0 0 4px var(--secondary-color);
            position: relative;
            z-index: 2;
        }

        section h2::after {
            content: '';
            position: absolute;
            width: 50%;
            height: 2px;
            bottom: -10px;
            left: 25%;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            animation: underlinePulse 2s infinite;
            z-index: 2;
        }

        @keyframes underlinePulse {
            0% { width: 50%; opacity: 1; }
            50% { width: 70%; opacity: 0.5; }
            100% { width: 50%; opacity: 1; }
        }

        .about {
            background: rgba(26, 26, 46, 0.5);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 var(--glow-intensity) rgba(0, 170, 255, 0.3);
            max-width: 600px;
            text-align: center;
        }

        .about-content {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            align-items: center;
        }

        .about-text {
            width: 100%;
        }

        .about-text p {
            line-height: 1.8;
            color: var(--text-muted);
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .carousel-container {
            max-width: 100%;
            margin: 0 auto 3rem auto;
            overflow: hidden;
            position: relative;
            border-radius: 20px;
            box-shadow: 0 0 var(--glow-intensity) rgba(0, 170, 255, 0.3);
        }

        .carousel {
            display: flex;
            transition: transform 0.5s ease;
        }

        .carousel-item {
            min-width: 100%;
            padding: 0.5rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            height: clamp(250px, 50vw, 400px);
        }

        .carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
            border: 2px solid var(--primary-color);
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.5);
            transition: transform 0.3s;
        }

        .carousel-item img:hover, .carousel-item img:focus {
            transform: scale(1.05);
        }

        .carousel-controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 0.5rem;
        }

        .carousel-controls button {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            width: clamp(40px, 8vw, 50px);
            height: clamp(40px, 8vw, 50px);
            border-radius: 50%;
            cursor: pointer;
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            transition: all 0.3s;
        }

        .carousel-controls button:hover, .carousel-controls button:focus {
            transform: scale(1.1);
            box-shadow: 0 0 calc(var(--glow-intensity) * 1.5) var(--primary-color);
        }

        .video-gallery {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            align-items: center;
        }

        .video-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 var(--glow-intensity) rgba(0, 170, 255, 0.3);
            transition: transform 0.3s;
            z-index: 1;
            opacity: 0;
            animation: fadeInVideo 0.5s forwards;
            width: 90%;
            max-width: 400px;
            background: rgba(26, 26, 46, 0.5);
            border: 2px solid var(--primary-color);
            cursor: pointer;
        }

        .video-item:nth-child(even) {
            margin-left: 0;
        }

        @keyframes fadeInVideo {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .video-item.hidden {
            display: none;
        }

        .video-item:hover {
            transform: translateY(-10px);
        }

        .video-item video {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .video-item::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 2px dashed var(--primary-color);
            border-radius: 20px;
            z-index: -1;
            opacity: 0.7;
            animation: laserFramePulse 3s infinite;
        }

        @keyframes laserFramePulse {
            0% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(1.02); }
            100% { opacity: 0.7; transform: scale(1); }
        }

        .see-more-container {
            text-align: center;
            margin-top: 1.5rem;
        }

        .see-more-btn {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 30px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            box-shadow: 0 0 var(--glow-intensity) var(--primary-color);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
        }

        .see-more-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.3s;
        }

        .see-more-btn:hover::before, .see-more-btn:focus::before {
            left: 100%;
        }

        .see-more-btn:hover, .see-more-btn:focus {
            box-shadow: 0 0 calc(var(--glow-intensity) * 2) var(--primary-color);
            transform: scale(1.1);
        }

        .contact {
            text-align: center;
            position: relative;
        }

        .contact p {
            color: var(--text-muted);
            margin-bottom: 1.5rem;
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .contact-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            padding: 0 0.5rem;
        }

        .contact a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            padding: 0.5rem 1rem;
            border: 1px solid var(--primary-color);
            border-radius: 25px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            z-index: 2;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        .contact a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.3s;
            z-index: -1;
        }

        .contact a:hover::before, .contact a:focus::before {
            left: 100%;
        }

        .contact a:hover, .contact a:focus {
            color: var(--secondary-color);
            box-shadow: 0 0 var(--glow-intensity) var(--secondary-color);
        }

        footer {
            position: relative;
            background: rgba(26, 26, 46, 0.5);
            backdrop-filter: blur(15px);
            padding: 2rem 1rem;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1;
            width: 100%;
            margin: 0 auto;
        }

        footer p {
            color: var(--text-muted);
            font-size: clamp(0.8rem, 2vw, 1rem);
            margin-bottom: 1rem;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        footer .footer-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
        }

        footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            transition: all 0.3s;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        footer a:hover, footer a:focus {
            color: var(--secondary-color);
            text-shadow: 0 0 10px var(--secondary-color);
        }

        @media (min-width: 768px) {
            header {
                padding: 1rem 2rem;
                justify-content: center;
            }

            .hamburger {
                display: none;
            }

            nav {
                display: flex;
                flex-direction: row;
                position: static;
                padding: 0;
                background: none;
                box-shadow: none;
            }

            nav a {
                margin: 0 1.5rem;
            }

            .hero {
                padding: 5rem 3rem 2rem;
            }

            .carousel-item {
                min-width: 33.33%;
            }

            .video-gallery {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
            }

            .video-item {
                margin: 0;
            }

            .video-item::before {
                display: block;
            }

            .contact-links {
                gap: 2rem;
                padding: 0;
            }
        }

        @media (min-width: 1024px) {
            .video-gallery {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <a href="#main-content" class="skip-link">Skip to content</a>
    <div class="preloader"></div>
    <div class="audio-overlay">
        <button aria-label="Enter Pretty Stitched Engraving and play background music">ENTER PRETTY STITCHED ENGRAVING</button>
    </div>
    <div class="background">
        <video class="background-video" src="https://engravinglaser.co.za/PSE/loopinfinity.mp4" autoplay loop muted playsinline preload="auto"></video>
        <div class="background-cube">
            <div class="front"></div>
            <div class="back"></div>
            <div class="left"></div>
            <div class="right"></div>
            <div class="top"></div>
            <div class="bottom"></div>
        </div>
        <div class="background-fallback"></div>
    </div>
    <div class="fullscreen-viewer">
        <img src="" alt="Fullscreen Image">
    </div>
    <audio id="bg-audio" src="/music/lofi.mp3" loop preload="auto" style="display: none;"></audio>
    <header>
        <div class="hamburger" role="button" aria-expanded="false" aria-label="Toggle navigation">☰</div>
        <nav>
            <a href="#about">About</a>
            <a href="#products">Products</a>
            <a href="#gallery">Gallery</a>
            <a href="#contact">Contact</a>
        </nav>
    </header>
    <a href="#" class="back-to-top" title="Back to Top" aria-label="Back to Top">↑</a>
    <a href="https://wa.me/27832227144" class="whatsapp-button" title="Chat on WhatsApp" aria-label="Chat on WhatsApp">
        <img src="/PSE/whatsapp.jpg" alt="WhatsApp Icon" loading="lazy">
    </a>
    <button class="audio-toggle" title="Toggle Music" aria-label="Toggle Background Music">♫</button>
    <section class="hero" id="main-content">
        <div class="title-container">
            <span>Pretty</span>
            <span>Stitched</span>
            <span>Engraving</span>
        </div>
        <img src="/PSE/pseLogoO.jpg" alt="Pretty Stitched Engraving Logo - Laser Engraving" id="hero-image" loading="eager">
        <p>Custom Laser Cutting & Engraving</p>
        <a href="#products" class="cta-button">Explore Products</a>
    </section>
    <section id="about" class="about">
        <div class="about-content">
            <div class="about-text">
                <h2>About Us</h2>
                <p>We specialize in creating personalized, high quality engraved products that make perfect gifts for everyone.</p>
                <p>Contact us at 0832227144 or prettystitchedengraving@gmail.com to bring your ideas to life!</p>
            </div>
        </div>
    </section>
    <section id="products">
        <h2>Our Products</h2>
        <div class="carousel-container">
            <div class="carousel">
                <div class="carousel-item"><img src="/PSE/gallery1.jpg" alt="Custom Engraved Product 1 by Pretty Stitched Engraving" loading="lazy"></div>
                <div class="carousel-item"><img src="/PSE/gallery2.jpg" alt="Custom Engraved Product 2 by Pretty Stitched Engraving" loading="lazy"></div>
                <div class="carousel-item"><img src="/PSE/gallery3.jpg" alt="Custom Engraved Product 3 by Pretty Stitched Engraving" loading="lazy"></div>
                <div class="carousel-item"><img src="/PSE/gallery4.jpg" alt="Custom Engraved Product 4 by Pretty Stitched Engraving" loading="lazy"></div>
                <div class="carousel-item"><img src="/PSE/gallery5.jpg" alt="Custom Engraved Product 5 by Pretty Stitched Engraving" loading="lazy"></div>
                <div class="carousel-item"><img src="/PSE/gallery6.jpg" alt="Custom Engraved Product 6 by Pretty Stitched Engraving" loading="lazy"></div>
            </div>
            <div class="carousel-controls">
                <button class="prev" aria-label="Previous slide">←</button>
                <button class="next" aria-label="Next slide">→</button>
            </div>
        </div>
    </section>
    <section id="gallery">
        <h2>Video Gallery</h2>
        <div class="video-gallery">
            <div class="video-item"><video src="/PSE/Indigo Pet drive 2025.mp4" controls poster="/PSE/Indigo Pet drive 2025.png" loading="lazy"></video></div>
            <div class="video-item"><video src="/PSE/Personalized pool cue.mp4" controls poster="/PSE/Personalized pool cue.png" loading="lazy"></video></div>
            <div class="video-item"><video src="/PSE/Christmas present.mp4" controls poster="/PSE/Christmas present.png" loading="lazy"></video></div>
            <div class="video-item"><video src="/PSE/Cheese lovers.mp4" controls poster="/PSE/Cheese lovers.png" loading="lazy"></video></div>
            <div class="video-item"><video src="/PSE/Gym Water bottle with rope handle.mp4" controls poster="/PSE/Gym Water bottle with rope handle.png" loading="lazy"></video></div>
            <div class="video-item"><video src="/PSE/Memes.mp4" controls poster="/PSE/Memes.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Rosegold wine tumbler.mp4" controls poster="/PSE/Rosegold wine tumbler.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/This rose will last forever.mp4" controls poster="/PSE/This rose will last forever.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Stitch wrap around.mp4" controls poster="/PSE/Stitch wrap around.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Moon Fairie.mp4" controls poster="/PSE/Moon Fairie.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Diaries.mp4" controls poster="/PSE/Diaries.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Monster Jam.mp4" controls poster="/PSE/Monster Jam.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Double Dragon.mp4" controls poster="/PSE/Double Dragon.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Spooky.mp4" controls poster="/PSE/Spooky.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Box cutting and engraving.mp4" controls poster="/PSE/Box cutting and engraving.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Merry Christmas.mp4" controls poster="/PSE/Merry Christmas.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Fairytale.mp4" controls poster="/PSE/Fairytale.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Rosegold Paisley wrap around.mp4" controls poster="/PSE/Rosegold Paisley wrap around.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Custom 20oz Tumbler Birthday Gift.mp4" controls poster="/PSE/Custom 20oz Tumbler Birthday Gift.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Pretty Stitched Engraving video.mp4" controls poster="/PSE/Pretty Stitched Engraving video.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Corporate gifts 3.8l water bottle.mp4" controls poster="/PSE/Corporate gifts 3.8l water bottle.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/KTM birthday present.mp4" controls poster="/PSE/KTM birthday present.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Fitness Freaks.mp4" controls poster="/PSE/Fitness Freaks.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Orange Dragon.mp4" controls poster="/PSE/Orange Dragon.png" loading="lazy"></video></div>
            <div class="video-item hidden"><video src="/PSE/Wine tumbler.mp4" controls poster="/PSE/Wine tumbler.png" loading="lazy"></video></div>
        </div>
        <div class="see-more-container">
            <button class="see-more-btn" aria-label="See more videos">See More</button>
        </div>
    </section>
    <section id="contact" class="contact">
        <h2>Get in Touch</h2>
        <p>Reach out for custom orders or inquiries!</p>
        <div class="contact-links">
            <a href="mailto:prettystitchedengraving@gmail.com">Email</a>
            <a href="tel:+27832227144">Call Us</a>
            <a href="https://www.tiktok.com/@diedrake" target="_blank" rel="noopener noreferrer">TikTok</a>
            <a href="https://www.facebook.com/share/1AGJEC1RfQ/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">Facebook</a>
            <a href="https://wa.me/27832227144" title="Chat on WhatsApp">WhatsApp</a>
        </div>
    </section>
    <footer>
        <p>© 2025 Pretty Stitched Engraving</p>
        <p>5 Hilton Street, Centurion, South Africa, 0157</p>
        <div class="footer-links">
            <a href="mailto:prettystitchedengraving@gmail.com">Contact Us</a>
            <a href="https://www.tiktok.com/@diedrake" target="_blank" rel="noopener noreferrer">TikTok</a>
            <a href="https://www.facebook.com/share/1AGJEC1RfQ/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">Facebook</a>
        </div>
    </footer>

    <script>
        particlesJS('particles-js', {
            particles: {
                number: { value: 60, density: { enable: true, value_area: 800 } },
                color: { value: '#00aaff' },
                shape: { type: 'circle' },
                opacity: { value: 0.5, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: '#00aaff', opacity: 0.4, width: 1 },
                move: { enable: true, speed: 2, direction: 'none', random: false, straight: false, out_mode: 'out' }
            },
            interactivity: {
                detect_on: 'canvas',
                events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' }, resize: true },
                modes: { repulse: { distance: 80, duration: 0.4 }, push: { particles_nb: 4 } }
            },
            retina_detect: true
        });

        const audio = document.getElementById('bg-audio');
        audio.volume = 0.3;

        const overlay = document.querySelector('.audio-overlay');
        const overlayButton = overlay.querySelector('button');
        overlayButton.addEventListener('click', () => {
            try {
                audio.play().then(() => {
                    console.log("Background audio started successfully");
                }).catch(error => {
                    console.warn("Background audio autoplay failed (likely browser policy):", error);
                });
            } catch (error) {
                console.error("Error attempting to play audio:", error);
            }
            overlay.classList.add('hidden');
            document.querySelector('.hero').style.opacity = 1;
            const heroImage = document.getElementById('hero-image');
            heroImage.classList.add('explode');
            setTimeout(() => {
                document.querySelector('.background-cube').classList.add('show-logos');
            }, 5000);
        });

        const hamburger = document.querySelector('.hamburger');
        const nav = document.querySelector('nav');
        hamburger.addEventListener('click', () => {
            const isExpanded = nav.classList.toggle('active');
            hamburger.textContent = isExpanded ? '✕' : '☰';
            hamburger.setAttribute('aria-expanded', isExpanded);
        });

        nav.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                nav.classList.remove('active');
                hamburger.textContent = '☰';
                hamburger.setAttribute('aria-expanded', 'false');
            });
        });

        function throttle(func, limit) {
            let inThrottle;
            return function() {
                if (!inThrottle) {
                    func.apply(this, arguments);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        let lastScrollTop = 0;
        window.addEventListener('scroll', throttle(() => {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const background = document.querySelector('.background');
            const fadeOutPoint = window.innerHeight * 0.5;
            const opacity = Math.max(0, 1 - scrollTop / fadeOutPoint);
            background.style.opacity = opacity;

            if (scrollTop > lastScrollTop) {
                document.querySelector('header').classList.add('hidden');
            } else {
                document.querySelector('header').classList.remove('hidden');
            }
            lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;

            const backToTop = document.querySelector('.back-to-top');
            if (scrollTop > 300) {
                backToTop.classList.add('visible');
            } else {
                backToTop.classList.remove('visible');
            }

            const sections = document.querySelectorAll('section');
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= window.innerHeight && rect.bottom >= 0) {
                    section.classList.add('visible');
                }
            });
        }, 100));

        let trailCount = 0;
        const maxTrails = 30;
        document.addEventListener('mousemove', throttle((e) => {
            if (trailCount < maxTrails) {
                const spark = document.createElement('div');
                spark.className = Math.random() > 0.3 ? 'engraving-spark' : 'engraving-flare';
                spark.style.left = `${e.clientX}px`;
                spark.style.top = `${e.clientY}px`;
                document.body.appendChild(spark);
                trailCount++;
                setTimeout(() => {
                    spark.remove();
                    trailCount--;
                }, spark.className === 'engraving-spark' ? 400 : 500);
            }
        }, 20));

        const audioToggle = document.querySelector('.audio-toggle');
        audioToggle.addEventListener('click', () => {
            if (audio.paused) {
                audio.play().catch(error => console.warn("Audio play failed:", error));
                audioToggle.textContent = '♫';
            } else {
                audio.pause();
                audioToggle.textContent = '♪';
            }
        });

        const videos = document.querySelectorAll('.video-item video');
        videos.forEach(video => {
            video.parentElement.addEventListener('click', () => {
                if (video.paused) {
                    video.play().then(() => {
                        audio.pause();
                    }).catch(error => console.warn("Video play failed:", error));
                } else {
                    video.pause();
                }
            });
            video.addEventListener('play', () => {
                audio.pause();
            });
            video.addEventListener('pause', () => {
                if (!document.querySelector('.video-item video:not(:paused)')) {
                    audio.play().catch(error => console.warn("Background audio resume failed:", error));
                }
            });
            video.addEventListener('ended', () => {
                audio.play().catch(error => console.warn("Background audio resume failed:", error));
            });
        });

        const seeMoreBtn = document.querySelector('.see-more-btn');
        const hiddenVideos = document.querySelectorAll('.video-item.hidden');
        let showingAll = false;
        seeMoreBtn.addEventListener('click', () => {
            showingAll = !showingAll;
            hiddenVideos.forEach(video => {
                video.classList.toggle('hidden', !showingAll);
            });
            seeMoreBtn.textContent = showingAll ? 'See Less' : 'See More';
        });

        VanillaTilt.init(document.querySelectorAll('.video-item'), {
            max: 10,
            speed: 400,
            glare: true,
            'max-glare': 0.4
        });

        const fullscreenViewer = document.querySelector('.fullscreen-viewer');
        const fullscreenImage = fullscreenViewer.querySelector('img');
        const carouselItems = document.querySelectorAll('.carousel-item');

        carouselItems.forEach(item => {
            item.addEventListener('click', () => {
                const imgSrc = item.querySelector('img').src;
                fullscreenImage.src = imgSrc;
                fullscreenViewer.classList.add('active');
                document.body.style.overflow = 'hidden';
            });
        });

        fullscreenViewer.addEventListener('click', () => {
            fullscreenViewer.classList.remove('active');
            document.body.style.overflow = 'auto';
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && fullscreenViewer.classList.contains('active')) {
                fullscreenViewer.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });

        const carousel = document.querySelector('.carousel');
        const items = document.querySelectorAll('.carousel-item');
        const prevBtn = document.querySelector('.prev');
        const nextBtn = document.querySelector('.next');
        let index = 0;
        let visibleItems = 1;

        function updateCarousel() {
            const itemWidth = items[0].offsetWidth;
            carousel.style.transform = `translateX(-${index * itemWidth}px)`;
            visibleItems = window.innerWidth >= 768 ? 3 : 1;
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index >= items.length - visibleItems;
        }

        nextBtn.addEventListener('click', () => {
            if (index < items.length - visibleItems) {
                index++;
                updateCarousel();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (index > 0) {
                index--;
                updateCarousel();
            }
        });

        window.addEventListener('resize', updateCarousel);

        function createLaserBeam() {
            const beam = document.createElement('div');
            beam.className = 'laser-beam';
            const isVertical = Math.random() > 0.5;
            if (isVertical) {
                beam.classList.add('vertical');
                beam.style.left = `${Math.random() * 100}vw`;
                beam.style.top = '0';
            } else {
                beam.classList.add('horizontal');
                beam.style.top = `${Math.random() * 100}vh`;
                beam.style.left = '0';
            }
            document.body.appendChild(beam);
            setTimeout(() => {
                beam.remove();
            }, 3000);
        }

        const backgroundVideo = document.querySelector('.background-video');
        const backgroundFallback = document.querySelector('.background-fallback');
        backgroundVideo.addEventListener('error', (e) => {
            console.error('Video failed to load:', e);
            backgroundVideo.style.display = 'none';
            backgroundFallback.style.display = 'block';
        });
        backgroundVideo.addEventListener('loadeddata', () => {
            console.log('Video loaded successfully');
            backgroundVideo.style.display = 'block';
            backgroundFallback.style.display = 'none';
        });
        if (!backgroundVideo.playing) {
            backgroundVideo.load();
            backgroundVideo.play().catch(e => console.error('Autoplay failed:', e));
        }

        window.addEventListener('load', () => {
            document.querySelector('.preloader').classList.add('hidden');
            updateCarousel();
            setInterval(() => {
                if (Math.random() > 0.5) {
                    createLaserBeam();
                }
            }, 1500);

            const heroImage = document.getElementById('hero-image');
            heroImage.addEventListener('load', () => {
                heroImage.style.opacity = 1;
            });
            heroImage.style.opacity = 0;
            heroImage.src = '/PSE/pseLogoO.jpg';

            document.querySelector('.hero').classList.add('visible');
        });

        document.querySelectorAll('.contact-links a, .whatsapp-button, .footer-links a').forEach(link => {
            link.addEventListener('click', (e) => {
                const label = e.target.textContent.trim() || e.target.getAttribute('title');
                gtag('event', 'click', {
                    'event_category': 'Interaction',
                    'event_label': label,
                    'value': 1
                });
            });
        });
    </script>
</body>
</html>
